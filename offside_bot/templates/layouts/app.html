{% extends "base.html" %}
{% from "macros/ui.html" import button, badge %}
{% set body_class = "app-page" %}

{% block body %}
  <div class="topbar">
    <div class="flex gap-10 items-center">
      <button
        class="icon-btn"
        type="button"
        data-sidebar-toggle
        aria-label="{{ t('nav.toggle_menu') }}"
        aria-controls="app-sidebar"
        aria-expanded="false"
      >
        &#9776;
      </button>
      <a class="brand" href="/app">
        <img
          class="brand-logo"
          src="{{ static_url('brand/logo.svg') }}"
          alt="{{ brand|default('Offside') }}"
          width="24"
          height="24"
        />
        <span>{{ brand|default("Offside") }}</span>
      </a>
    </div>
    <div class="flex gap-10 items-center">
      {% if guild_selector %}
        <select aria-label="{{ t('nav.select_server') }}" onchange="window.location=this.value">
          {% for opt in guild_selector %}
            <option value="{{ opt.href }}" {% if opt.selected %}selected{% endif %}>{{ opt.label }}</option>
          {% endfor %}
        </select>
      {% endif %}
      {% if plan_badge %}
        {{ plan_badge|safe }}
      {% endif %}
      {% if install_badge %}
        {{ install_badge|safe }}
      {% endif %}
    </div>
    <div class="flex gap-10 items-center">
      {% if invite_cta %}
        {{ invite_cta|safe }}
      {% endif %}
      <span class="muted">{{ username }}</span>
      <a class="btn secondary" href="/logout">{{ t("nav.logout") }}</a>
    </div>
  </div>

  <div class="layout">
    <div class="sidebar-backdrop" data-sidebar-toggle aria-hidden="true"></div>
    <aside class="sidebar" id="app-sidebar" aria-label="Navigation">
      <div class="card">
        {% if nav_items %}
          {% for item in nav_items %}
            <a
              class="navlink {% if item.active %}active{% endif %}"
              href="{{ item.href }}"
              {% if item.active %}aria-current="page"{% endif %}
            >
              {{ item.label }}
            </a>
          {% endfor %}
        {% else %}
          <div class="muted">Select a server to see modules.</div>
        {% endif %}
      </div>
    </aside>
    <main class="content" id="main-content" tabindex="-1">
      {% if plan_notice %}
        {{ plan_notice|safe }}
      {% endif %}
      {% block content %}{% endblock %}
    </main>
  </div>
{% endblock %}
